"use strict";var e=require("commander"),t=require("path"),r=require("chalk"),n=require("ora"),a=require("fs-extra"),o=require("download-git-repo"),u=require("inquirer");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=c(e),i=c(t),l=c(r),p=c(n),f=c(a),d=c(o),m=c(u);function y(e,t,r,n,a,o,u){try{var c=e[o](u),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function u(e){y(o,n,a,u,c,"next",e)}function c(e){y(o,n,a,u,c,"throw",e)}u(void 0)}))}}var g="@juyren/library-cli",v="2.1.0",w=s.default.program,j=g,x=v,k=function(){var e;return w.name(j).usage("<projectName> --template <type>").version(x),w.arguments("<projectName>").option("-t, --template <type>","develop the library with your type").action((function(t){e=t})).parse(process.argv),{projectName:e}};var b={spinner:p.default(),resolve:function(){return i.default.resolve.apply(i.default,arguments)},chalkError:function(){return l.default.bgRedBright.whiteBright("ERROR:")},chalkSuccess:function(){return l.default.bgGreenBright("SUCCESS:")},getQuestions:function(e){return[{message:"What is your project name?",name:"projectName",default:e},{message:"what is the version of your project?",name:"version",default:"1.0.0"},{message:"How do you describe your project?",name:"description"},{message:"What is the author of your project?",name:"author"},{message:"What keywords do you want to set for your project?",name:"keywords"},{message:"What is the git repository of your project",name:"git"}]}},R={javascript:{fullName:"javascript",alias:"js"},typescript:{fullName:"typescript",alias:"ts"}},q=s.default.program,E=b.spinner,N=b.resolve,S=b.chalkError,W=b.getQuestions;function B(){return(B=h(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=N(process.cwd(),t),E.color="yellow",E.start(l.default.yellow("检测目录中...")),e.next=5,f.default.pathExists(r);case 5:if(!e.sent){e.next=8;break}E.fail(l.default.red("".concat(t,"目录已存在"))),process.exit(1);case 8:return E.stop(),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=h(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.default.prompt(W(t));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P=b.chalkError,C=function(e){return B.apply(this,arguments)},F=function(){var e=q.template;return e||(console.log(S(),l.default.red("缺少--template <type> 选项")),process.exit(1)),Object.keys(R).includes(e)||(console.log(S(),l.default.red("<type>参数必须".concat(Object.keys(R).join(","),"为之一"))),process.exit(1)),R[e]},Q=function(e){return O.apply(this,arguments)},D=function(e,t){var r=e.alias,n=e.fullName;return E.color="yellow",E.start(l.default.yellow("Wait for the remote ".concat(n," template to download ..."))),new Promise((function(e,n){d.default("github:JuyRen/library-cli-repo#".concat(r),t,(function(t){t&&(E.fail(l.default.red(t)),n(),process.exit(1)),E.succeed(l.default.green("Download successfully!")),e()}))}))},G=function(e,t){E.color="yellow",E.start(l.default.yellow("Wait for initial template ...")),setTimeout((function(){var r=N(t,"./package.json"),n=f.default.readFileSync(r,"utf-8");Reflect.ownKeys(e).forEach((function(t){var r=new RegExp("{{".concat(t,"}}"),"g"),a=e[t];n=n.replace(r,a)})),f.default.writeFileSync(r,n,"utf-8"),E.succeed(l.default.green("Init template successfully"))}),500)};function H(){return(H=h(regeneratorRuntime.mark((function e(){var t,r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=k(),r=t.projectName,n=F(),e.next=4,C(r);case 4:return a=e.sent,e.next=7,Q(r);case 7:return o=e.sent,e.next=10,D(n,a);case 10:G(o,a);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return H.apply(this,arguments)})().catch((function(e){console.log(P(),e),process.exit(1)}));module.exports={};
